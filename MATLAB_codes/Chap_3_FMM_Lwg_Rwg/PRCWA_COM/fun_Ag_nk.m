%%% Ag의 n, k값 구하는 함수 %%%
%   - lambda : 102.5nm~9919nm
%   - Using Lagrange interpolation


function result=fun_Ag_nk(lambda);

lambda=lambda*10^9;

Ag_data=[ 102.5   1.308   0.581  ; 105.1   1.304   0.578  ; 107.8    1.3    0.573  ; 110.7   1.293   0.566  ;
 113.7    1.28    0.56  ;  117    1.265    0.56  ; 120.4   1.252   0.564  ; 127.8   1.229   0.566  ;
 134.8   1.182    0.55  ; 137.8   1.149   0.552  ; 140.9   1.112   0.563  ; 144.2   1.073   0.581  ;
 147.6   1.032    0.61  ; 151.2   0.993   0.653  ;  155    0.962   0.706  ;  159     0.94    0.77  ;
 163.1   0.935   0.832  ; 167.5   0.936   0.892  ; 172.2   0.942   0.951  ; 177.1   0.953    1.01  ;
 182.3   0.969    1.07  ; 187.9   0.995    1.13  ; 193.7   1.028    1.18  ; 196.8   1.048    1.21  ;
  200    1.072    1.24  ; 203.3   1.098    1.26  ; 206.6   1.125    1.27  ; 213.8   1.173    1.29  ;
 221.4   1.208    1.3   ; 229.6   1.238    1.31  ; 238.4   1.265    1.33  ;  248    1.298    1.35  ;
  253     1.32    1.35  ; 258.3   1.343    1.35  ; 263.8   1.372    1.35  ; 269.5   1.404    1.33  ;
 275.5   1.441    1.31  ; 281.8   1.476    1.26  ; 288.3   1.502    1.19  ; 295.2   1.519    1.08  ;
 298.8   1.522   0.992  ; 302.4   1.496   0.882  ; 306.1   1.432   0.766  ;  310    1.323   0.647  ;
 311.5   1.246   0.586  ; 313.9   1.149    0.54  ; 315.5   1.044   0.514  ; 317.9   0.932   0.504  ;
 319.5   0.815   0.526  ;  322    0.708   0.565  ; 323.7   0.616   0.609  ; 326.3   0.526   0.663  ;
 330.6   0.371   0.813  ; 332.4   0.321   0.902  ; 335.1   0.294   0.986  ; 339.7   0.259    1.12  ;
 344.4   0.238    1.24  ; 354.2   0.209    1.44  ; 364.7   0.186    1.61  ; 375.7    0.2     1.67  ;
 387.5   0.192    1.81  ;  400    0.173    1.95  ; 413.3   0.173    2.11  ; 427.5    0.16    2.26  ;
 442.8   0.157    2.4   ; 459.2   0.144    2.56  ; 476.9   0.132    2.72  ; 495.9    0.13    2.88  ;
 516.6    0.13    3.07  ; 539.1   0.129    3.25  ; 563.6    0.12    3.45  ; 590.4   0.121    3.66  ;
 619.9   0.131    3.88  ; 652.6    0.14    4.15  ; 688.8    0.14    4.44  ; 729.3   0.148    4.74  ;
 774.9   0.143    5.09  ; 826.6   0.145    5.5   ; 885.6   0.163    5.95  ; 953.7   0.198    6.43  ;
  1033   0.226    6.99  ;  1127   0.251    7.67  ;  1240   0.329    8.49  ;  1265   0.375    7.78  ;
  1291   0.383    7.92  ;  1305   0.358    8.95  ;  1319   0.392    8.06  ;  1348   0.401    8.21  ;
  1378   0.411    8.37  ;  1409   0.421    8.37  ;  1442   0.431    8.7   ;  1459   0.446    10.1  ;
  1476   0.442    8.88  ;  1512   0.455    9.08  ;  1550   0.469    9.32  ;  1590   0.485    9.57  ;
  1631   0.501    9.84  ;  1653   0.624    11.5  ;  1675   0.519    10.1  ;  1771   0.557    10.7  ;
  1823   0.578    11.1  ;  1879    0.6     11.4  ;  1907   0.873    13.3  ;  1937   0.624    11.8  ;
  2000    0.65    12.2  ;  2066   0.668    12.6  ;  2138   0.729     13   ;  2214   0.774    13.5  ;
  2296   0.823     14   ;  2384   0.878    14.5  ;  2480   0.939    15.1  ;  2583   1.007    15.7  ;
  2695   1.083    16.4  ;  2818   1.168    17.1  ;  2952   1.265    17.9  ;  3100   1.387    18.8  ;
  3263   1.536    19.8  ;  3444    1.71    20.9  ;  3647   1.915    22.1  ;  3875    2.16    23.5  ;
  4133   2.446    25.1  ;  4428   2.786    26.9  ;  4769   3.202     29   ;  5166   3.732    31.3  ;
  5636   4.425     34   ;  6199   5.355     37   ;  6526    5.96    38.6  ;  6888    6.67    40.4  ;
  7293   7.461    42.5  ;  7749   8.376    44.8  ;  8266   9.441    47.1  ;  8856   10.69    49.4  ;
  9537   12.21    52.2  ;  9919   13.11    53.7  ];


Ag_data_length=length(Ag_data(:,1));
for cnt=1:Ag_data_length-1
    if (lambda>=Ag_data(cnt,1))&(lambda<Ag_data(cnt+1,1))
        break;
    end
end


%%% Lagrange interpolation %%%
xi=Ag_data(cnt,1);   ni=Ag_data(cnt,2);   ki=Ag_data(cnt,3);
xj=Ag_data(cnt+1,1);   nj=Ag_data(cnt+1,2);   kj=Ag_data(cnt+1,3);
x=lambda;

n=(x-xj)/(xi-xj)*ni+(x-xi)/(xj-xi)*nj;
k=(x-xj)/(xi-xj)*ki+(x-xi)/(xj-xi)*kj;

result=n+j*k;
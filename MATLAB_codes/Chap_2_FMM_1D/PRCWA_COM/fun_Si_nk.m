%%% Si n, k  
% - lambda : 250nm ~ 1000nm
% - Using Lagrange interpolation

function result=fun_Si_nk(lambda)

lambda=lambda*10^9;

Si_data=[ 250   1.694   3.666; 260   1.800   4.072; 270   2.129   4.690; 280   3.052   5.258;
290   4.426   5.160; 300   5.055   4.128; 310   5.074   3.559; 320   5.102   3.269; 330   5.179   3.085;
340   5.293   2.951; 350   5.483   2.904; 360   6.014   2.912; 370   6.863   2.051; 380   6.548   0.885;
390   5.976   0.465; 400   5.587   0.303; 410   5.305   0.220; 420   5.091   0.167; 430   4.925   0.134;
440   4.793   0.109; 450   4.676   0.091; 460   4.577   0.077; 470   4.491   0.064; 480   4.416   0.057;
490   4.348   0.050; 500   4.293   0.045; 510   4.239   0.039; 520   4.192   0.036; 530   4.150   0.033;
540   4.110   0.030; 550   4.077   0.028; 560   4.044   0.026; 570   4.015   0.024; 580   3.986   0.023;
590   3.962   0.021; 600   3.939   0.020; 610   3.916   0.018; 620   3.895   0.017; 630   3.879   0.016;
640   3.861   0.015; 650   3.844   0.015; 660   3.830   0.014; 670   3.815   0.013; 680   3.800   0.012;
690   3.787   0.011; 700   3.774   0.011; 710   3.762   0.011; 720   3.751   0.010; 730   3.741   0.009;
740   3.732   0.008; 750   3.723   0.008; 760   3.714   0.007; 770   3.705   0.007; 780   3.696   0.006;
790   3.688   0.006; 800   3.681   0.005; 810   3.674   0.005; 820   3.668   0.005; 830   3.662   0.004;
840   3.656   0.004; 850   3.650   0.004; 860   3.644   0.003; 870   3.638   0.003; 880   3.632   0.003;
890   3.626   0.002; 900   3.620   0.002; 910   3.614   0.002; 920   3.608   0.002; 930   3.602   0.002;
940   3.597   0.001; 950   3.592   0.001; 960   3.587   0.001; 970   3.582   0.001; 980   3.578   0.001;
990   3.574   0.001; 1000 3.570   0.001];


Si_data_length=length(Si_data(:,1));
for cnt=1:Si_data_length-1
    if (lambda>=Si_data(cnt,1))&(lambda<Si_data(cnt+1,1))
        break;
    end
end


%%% Lagrange interpolation %%%
xi=Si_data(cnt,1);   ni=Si_data(cnt,2);   ki=Si_data(cnt,3);
xj=Si_data(cnt+1,1);   nj=Si_data(cnt+1,2);   kj=Si_data(cnt+1,3);
x=lambda;

n=(x-xj)/(xi-xj)*ni+(x-xi)/(xj-xi)*nj;
k=(x-xj)/(xi-xj)*ki+(x-xi)/(xj-xi)*kj;

result=n+j*k;